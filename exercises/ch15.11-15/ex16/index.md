# 問題

## クロスオリジンリクエストに制約が無かった場合、どのような問題が発生するか述べなさい

以下のような攻撃の被害を受けるリスクが発生する。

### クロスサイトリクエストフォージェリ(CSRF)

悪意のあるウェブサイトが、ユーザーがログインしている別のサイトに対してリクエストを送信し、ユーザーの意図しない操作を行うことができる。
これにより、ユーザーのデータが漏洩したり、不正な操作が行われる可能性がある。

### クロスサイトスクリプティング(XSS)

悪意のあるスクリプトが別のオリジンから読み込まれ、ユーザーのブラウザで実行されることで、ユーザーのデータが盗まれたり、セッションが乗っ取られる可能性がある。

## クロスオリジンリクエストで メソッド(POST/GET)やリクエストの内容によって Preflight リクエストの有無が異なるのは何故か、その理由を述べなさい

互換性や歴史的経緯によるもの。

CORSが標準化されたのは2008年だが、Same Origin Policyが導入されたのは1990年代半ばでそれより古い。
CORS以前のSame Origin Policy下でも、`<form>`からのリクエストなどは安全なリクエストと見なされ、許容されていた。

そのようなCORS以前から許可されていた単純なリクエスト(Simple Request)に対してもPreflight Requestを送るようにすると、CORS以前の既存のアプリケーションに不具合が生じる可能性がある。
(CORS以前のアプリケーションは当然Preflight RequestなどCORSの仕組みに対応していないため)

そのため、 メソッド(POST/GET)やリクエストの内容によってPreflightリクエストの有無が異なる。

ちなみに、以下の条件すべてをみたすものが単純なリクエスト(Simple Request)である。

- 許可されているメソッドが GET, HEAD, POST のいずれかであること
- 手動で設定できるリクエストヘッダは以下のいずれかであること（ユーザエージェントによって自動的に付与されるヘッダーを除く）
  - Accept
  - Accept-Langage
  - Content-Langage
  - Content-Type
- Content-Typeのヘッダは以下のいずれかであること
  - application/x-www-form-urlencoded
  - multipart/form-data
  - text/plain

参考:
[【CORS】なぜ、Preflight Request が発生するときとしないときがあるのか](https://zenn.dev/tm35/articles/ad05d8605588bd)